{% extends "base.html" %}
{% block title %}Sign Up — VulnMap{% endblock %}
{% block content %}

<div class="card rtl" style="max-width:560px;margin-inline:auto;">
  <h2 style="margin-bottom:6px;">إنشاء حساب</h2>
  <p class="small muted" style="margin-top:0;">
    التسجيل متاح فقط للمستخدمين المدعوين مسبقاً. أدخل <strong>رقم المعرّف المصرّح</strong> الذي حصلت عليه من الإدارة.
  </p>

  <form method="post" action="{{ url_for('signup') }}" style="display:grid;gap:12px;margin-top:14px;">
    <div style="display:grid;gap:10px;grid-template-columns:1fr 1fr;">
      <div>
        <label>الاسم الأول</label>
        <input class="input" type="text" name="first_name" autocomplete="given-name" placeholder="مثال: Rayan">
      </div>
      <div>
        <label>اسم العائلة</label>
        <input class="input" type="text" name="family_name" autocomplete="family-name" placeholder="مثال: Al-X">
      </div>
    </div>

    <div>
      <label>اسم المستخدم</label>
      <input class="input" type="text" name="username" required autocomplete="username" minlength="2" placeholder="اسم المستخدم">
    </div>

    <div>
      <label>رقم الجوال</label>
      <input class="input" type="tel" name="phone_number" autocomplete="tel" placeholder="05XXXXXXXX">
      <div class="small muted" style="margin-top:6px;">الرجاء كتابة رقمك بالصيغة التاليه: 05XXXXXXXX</div>
    </div>

    <div style="display:grid;gap:10px;grid-template-columns:1fr 1fr;">
      <div>
        <label>كلمة المرور</label>
        <input class="input" id="pw" type="password" name="password" required autocomplete="new-password" minlength="6" placeholder="••••••••">
      </div>
      <div>
        <label>تأكيد كلمة المرور</label>
        <input class="input" id="pw2" type="password" name="confirm_password" required autocomplete="new-password" minlength="6" placeholder="••••••••">
      </div>
    </div>

    <div>
      <label>رقم المعرّف المصرّح (إلزامي)</label>
      <input id="approved-id-input" class="input" type="text" name="approved_id" placeholder="أدخل رقم المعرّف من الإدارة" required>
      <div class="small muted" style="margin-top:6px;">
        إذا لم يكن لديك معرّف مصرح، تواصل مع الإدارة للحصول عليه.
      </div>
    </div>

    <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
      <button class="btn" type="submit">إنشاء</button>
      <a class="btn secondary" href="{{ url_for('login') }}">لديك حساب؟ تسجيل الدخول</a>
    </div>
  </form>
</div>

{% endblock %}

{% block scripts %}
<script>
  (function(){
    // Client-side password confirmation (server still validates)
    var pw = document.getElementById('pw');
    var pw2 = document.getElementById('pw2');
    [pw, pw2].forEach(function(el){
      el && el.addEventListener('input', function(){
        if(!pw || !pw2) return;
        var ok = pw.value && pw2.value && pw.value === pw2.value;
        pw2.style.borderColor = ok ? '#39548b' : '#8a2730';
      });
    });
  })();
</script>
{% endblock %}
